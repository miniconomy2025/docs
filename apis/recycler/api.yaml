openapi: 3.0.0
info:
  title: Recycler API for Economic Simulator
  version: 1.0.0
  description: >
    API for simulating recycling operations in a mini economy.
    Includes phone recycling, raw material tracking, supplier orders, and company registration.

paths:

  /materials:
    get:
      summary: Get info on raw materials
      tags:
        - Materials
      description: Returns a list of raw materials currently available in the Recycler's inventory.
      responses:
        '200':
          description: Successfully retrieved raw materials
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/RawMaterialDto'

  /orders:
    post:
      summary: Create a raw materials order
      tags:
        - Orders
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateOrderCommand'
      responses:
        '200':
          description: Order created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Order'

    get:
      summary: View all orders
      tags:
        - Orders
      responses:
        '200':
          description: List of orders with details
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Order'

  /orders/{order_number}:
    get:
      summary: View specific order by order number
      tags:
        - Orders
      parameters:
        - name: order_number
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Order details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Order'

  /companies:
    post:
      summary: Create a company
      tags:
        - Companies
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateCompanyCommand'
      responses:
        '201':
          description: Company created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CreateCompanyResponse'

  /simulation:
    post:
      summary: Start simulation
      tags:
        - Simulation
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/StartSimulationCommand'
      responses:
        '200':
          description: Simulation started
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StartSimulationResponse'

  /api/Machines/receive:
    post:
      summary: Receive machine delivery
      tags:
        - Machines
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ReceiveMachineCommand'
      responses:
        '201':
          description: Machine received
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ReceivedMachineDto'

components:
  schemas:

    CreateOrderCommand:
      type: object
      required: [supplierId, orderItems]
      properties:
        supplierId:
          type: integer
        orderItems:
          type: array
          items:
            $ref: '#/components/schemas/CreateOrderItemDto'

    CreateOrderItemDto:
      type: object
      properties:
        materialId:
          type: integer
        quantity:
          type: integer

    Order:
      type: object
      properties:
        orderNumber:
          type: string
          format: uuid
        supplierName:
          type: string
        createdAt:
          type: string
          format: date-time
        status:
          type: string

    CreateCompanyCommand:
      type: object
      properties:
        name:
          type: string
        roleId:
          type: integer

    CreateCompanyResponse:
      type: object
      properties:
        companyId:
          type: integer
        name:
          type: string
        role:
          type: string

    StartSimulationCommand:
      type: object
      properties:
        startTime:
          type: integer
          format: int64
          nullable: true

    StartSimulationResponse:
      type: object
      properties:
        status:
          type: string
        message:
          type: string

    RawMaterialDto:
      type: object
      required:
        - name
      properties:
        name:
          type: string
        availableQuantityInKg:
          type: number
          format: double
        pricePerKg:
          type: number
          format: double

    ReceiveMachineCommand:
      type: object
      properties:
        machineId:
          type: integer

    ReceivedMachineDto:
      type: object
      properties:
        id:
          type: integer
        machineId:
          type: integer
        receivedAt:
          type: string
          format: date-time
        status:
          type: string

tags:
  - name: Orders
  - name: Companies
  - name: Simulation
  - name: Materials
  - name: Machines
